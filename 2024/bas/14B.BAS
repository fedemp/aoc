10 DEF FNMOE(A,B)=A-B*INT(A/B)
20 BX = 101: BY = 103: DIM B%(BX,BY): FOR ITER=1 TO 101*103
30 OPEN "I", #1, "input14.txt"
40 WHILE NOT EOF(1): LINE INPUT #1, LN$
50 PX# = VAL(MID$(LN$, INSTR(LN$, "=")+1, INSTR(LN$, ",") -1))
60 PY# = VAL(MID$(LN$, INSTR(LN$, ",")+1, INSTR(LN$, " ") -1))
70 LN$ = MID$(LN$, INSTR(LN$, " ") + 1)
80 VX = VAL(MID$(LN$, INSTR(LN$, "=")+1, INSTR(LN$, ",") -1))
90 VY = VAL(MID$(LN$, INSTR(LN$, ",")+1))
100 PX# = FNMOE(FNMOE(PX# + VX * ITER, BX) + BX, BX)
110 PY# = FNMOE(FNMOE(PY# + VY * ITER, BY) + BY, BY)
120 IF B%(PX#,PY#) > 0 GOTO 1070
130 B%(PX#,PY#) = 1: WEND
1000 OPEN "o", #2, MID$(STR$(ITER),2) + ".ppm"
1010 PRINT #2, "P3"
1020 PRINT #2, STR$(BX), " ", STR$(BY)
1030 PRINT #2, "255"
1040 FOR Y=0 TO BY-1: FOR X=0 TO BX-1
1050 V$ = STR$(255 * B%(X,Y)): PRINT #2, V$ V$ V$;
1060 NEXT X: PRINT #2, "": NEXT Y
1070 ERASE B%: DIM B%(BX,BY): CLOSE #2: CLOSE #1: NEXT ITER
