10 REM CLS
20 OPEN "i", #1, "input.txt"
30 OPEN "o", #2, "output.txt"
40 IF EOF(1) THEN GOTO 160
50 LINE INPUT #1, CURRL$
60 ITEMS = 1
70 FOR I=1 TO LEN(CURRL$)
80 CH$ = MID$(CURRL$, I, 1)
90 IF CH$=" " THEN MID$(CURRL$,I,1) = ",": ITEMS = ITEMS + 1
100 NEXT I
110 FOR J=1 TO 8-ITEMS
120 CURRL$ = CURRL$ + ","
130 NEXT J
140 PRINT #2, CURRL$
150 GOTO 40
160 CLOSE #1, #2
170 OPEN "i", #3, "OUTPUT.TXT"
175 OPEN "o", #1, "FAULT.TXT"
180 TOTAL = 0: DIM V(7): DIM OG(7)
190 IF EOF(3) THEN PRINT TOTAL: CLOSE #3: KILL "output.txt": END
200 INPUT #3, V1,V2,V3,V4,V5,V6,V7,V8
210 V(0) = V1: V(1) = V2: V(2) = V3: V(3) = V4
220 V(4) = V5: V(5) = V6: V(6) = V7: V(7) = V8
230 GOSUB 1000
240 IF VALID = 1 THEN TOTAL = TOTAL + 1: GOTO 190
250 REM START FAULT TOLERANCE
260 REM KEEP ORIGINAL
270 FOR G=0 TO 7: OG(G) = V(G): NEXT G
275 FOR G=0 TO 7: V(G) = 0: NEXT G
280 FOR TRI=0 TO 7: IX=0: FOR J=0 TO 7
290 IF TRI<>J THEN V(IX) = OG(J): IX=IX+1
300 NEXT J
310 GOSUB 1000
320 IF VALID = 1 GOTO 240 ELSE NEXT TRI
330 REM FAULT TOLERANCE FAILED
335 FOR P=0 TO 7: PRINT #1, V(P);: NEXT P: PRINT #1,""
340 GOTO 190
1000 REM CHECK ARRAY
1010 ORDER$ = "": VALID = 0
1020 FOR I=0 TO 6
1030 IF V(I+1) = 0 THEN VALID = 1: RETURN
1040 IF ORDER$ = "" AND V(I) > V(I+1) THEN ORDER$ = "d"
1050 IF ORDER$ = "" AND V(I) < V(I+1) THEN ORDER$ = "a"
1060 RESULT = ABS(V(I) - V(I+1))
1070 IF RESULT > 3 OR RESULT = 0 THEN RETURN
1080 IF ORDER$ = "d" AND V(I) < V(I+1) THEN RETURN
1090 IF ORDER$ = "a" AND V(I) > V(I+1) THEN RETURN
1100 NEXT I
1110 VALID = 1: RETURN
