10 OPEN "i", #1, "input.txt"
20 TOTAL# = 0: EN = 1: F$ = "": S$ = ""
30 IF EOF(1) THEN PRINT TOTAL#: END
40 CH$ = INPUT$(1,#1)
50 IF CH$ = "m" AND EN = 1 THEN GOSUB 80
60 IF CH$ = "d" THEN GOSUB 380
70 GOTO 30
80 REM PARSE MUL
90 IF EOF(1) GOTO 30
100 CH$ = INPUT$(1,#1)
110 IF CH$ <> "u" THEN RETURN
120 IF EOF(1) GOTO 30
130 CH$ = INPUT$(1,#1)
140 IF CH$ <> "l" THEN RETURN
150 IF EOF(1) GOTO 30
160 CH$ = INPUT$(1,#1)
170 IF CH$ <> "(" THEN RETURN
180 GOSUB 200 ' Start getting numbers
190 RETURN
200 REM START GETTING NUMBERS
210 F$ = "": S$ = "": C$ = "" ' First, second and current
220 IF EOF(1) GOTO 30
230 CH$ = INPUT$(1,#1)
240 GOSUB 350 ' Set current number
250 IF C$ <> "" THEN F$ = F$ + C$: GOTO 220
260 IF CH$ = "," AND F$ <> "" GOTO 280
270 RETURN ' No "," or number
280 IF EOF(1) GOTO 30
290 CH$ = INPUT$(1, #1)
300 GOSUB 350 ' Set current number
310 IF C$ <> "" THEN S$ = S$ + C$: GOTO 280
320 IF CH$ = ")" AND S$ = "" THEN RETURN
330 IF CH$ <> ")" THEN RETURN
340 TOTAL# = TOTAL# + (VAL(F$) * VAL(S$)): RETURN
350 REM SET CURRENT NUMBER
360 IF ASC(CH$) < 48 OR ASC(CH$) > 57 THEN C$ = "" ELSE C$ = CH$
370 RETURN
380 REM TOGGLE ENABLED
390 IF EOF(1) GOTO 30
400 CH$ = INPUT$(1,#1)
410 IF CH$ <> "o" THEN RETURN
420 IF EOF(1) GOTO 30
430 CH$ = INPUT$(1,#1)
440 IF CH$ = "(" AND EN = 0 THEN GOTO 460
450 IF CH$ = "n" AND EN = 1 THEN GOTO 460 ELSE RETURN
460 IF EOF(1) GOTO 30
470 CH$ = INPUT$(1, #1)
480 IF CH$ = ")" AND EN = 0 THEN EN = 1: RETURN
490 IF CH$ = "'" AND EN = 1 GOTO 510 ELSE RETURN
500 STOP
510 IF EOF(1) GOTO 30
520 CH$ = INPUT$(1,#1)
530 IF CH$ <> "t" THEN RETURN
540 IF EOF(1) GOTO 30
550 CH$ = INPUT$(1, #1)
560 IF CH$ <> "(" THEN RETURN
570 IF EOF(1) GOTO 30
580 CH$ = INPUT$(1,#1)
590 IF CH$ <> ")" THEN RETURN
600 EN = 0: RETURN
