10 CLS: OPEN "i",#1,"INPUT.TXT"
20 DIM M%(139,139) : ML = -1
30 IF EOF(1) THEN GOTO 80
40 LINE INPUT #1, L$
50 ML = ML + 1
60 FOR I=1 TO 140 : M%(ML,I-1) = ASC(MID$(L$, I, 1)): NEXT I
65 FOR P=0 TO 139 : PRINT M%(ML,P); : NEXT P : PRINT ""
70 GOTO 30
80 FOR L = 0 TO 139: FOR I=0 TO 139
100 IF M%(L,I) = 88 THEN GOSUB 1000
105 NEXT I: NEXT L
110 PRINT TOTAL
120 END
1000 REM START LOOKING AROUND
1010 REM TO THE RIGHT
1020 IF I+3 > 139 THEN GOTO 1040
1030 IF M%(L,I+1) = 77 AND M%(L,I+2) = 65 AND M%(L,I+3) = 83 THEN GOSUB 2000
1040 REM TO THE LEFT
1050 IF I-3 < 0 THEN GOTO 1070
1060 IF M%(L,I-1) = 77 AND M%(L,I-2) = 65 AND M%(L,I-3) = 83 THEN GOSUB 2000
1070 REM BELOW
1080 IF L+3 > 139 THEN GOTO 1100
1090 IF M%(L+1,I) = 77 AND M%(L+2,I) = 65 AND M%(L+3,I) = 83 THEN GOSUB 2000
1100 REM ABOVE
1110 IF L-3 < 0 THEN GOTO 1140
1120 IF M%(L-1,I) = 77 AND M%(L-2,I) = 65 AND M%(L-3,I) = 83 THEN GOSUB 2000
1130 REM NORTH WEST
1140 IF I-3 < 0 OR L-3 < 0 GOTO 1160
1150 IF M%(L-1,I-1)=77 AND M%(L-2,I-2)=65 AND M%(L-3,I-3)=83 THEN GOSUB 2000
1160 REM NORTH EAST
1170 IF I+3 > 139 OR L-3 < 0 GOTO 1190
1180 IF M%(L-1,I+1)=77 AND M%(L-2,I+2)=65 AND M%(L-3,I+3)=83 THEN GOSUB 2000
1190 REM SOUTH WEST
1200 IF L+3 > 139 OR I-3 < 0 GOTO 1220
1210 IF M%(L+1,I-1)=77 AND M%(L+2,I-2)=65 AND M%(L+3,I-3)=83 THEN GOSUB 2000
1220 REM SOUTH EAST
1230 IF L+3 > 139 OR I+3 > 139 GOTO 1250
1240 IF M%(L+1,I+1)=77 AND M%(L+2,I+2)=65 AND M%(L+3,I+3)=83 THEN GOSUB 2000
1250 RETURN
2000 TOTAL = TOTAL + 1 : RETURN
