10 CLS: OPEN "i",#1,"INPUT.TXT"
20 X = 140: DIM M%(X,X) : ML = -1 : TOTAL = 0
30 IF EOF(1) THEN GOTO 80
40 LINE INPUT #1, L$
50 ML = ML + 1
60 FOR I=1 TO X : M%(ML,I-1)=ASC(MID$(L$,I,1)): PRINT M%(ML,I-1);
65 NEXT I: PRINT ""
70 GOTO 30
75 STOP
80 FOR L = 0 TO X: FOR I=0 TO X
100 IF M%(L,I) = 77 THEN GOSUB 1000
105 NEXT I: NEXT L
110 PRINT "TOTAL", TOTAL
120 END
1000 REM SUB: START LOOKING AROUND
1010 IF I + 2 < X GOTO 1020 ELSE GOTO 1040
1020 REM SEARCH M ON THE RIGHT
1030 IF M%(L,I+2) = 77 THEN GOSUB 2000
1040 REM SEARCH M BELOW
1050 IF L + 2 < X GOTO 1060 ELSE GOTO 1080
1060 REM SEARCH M BELOW
1070 IF M%(L+2, I) = 77 THEN GOSUB 3000
1080 RETURN
2000 REM SUB: M ON THE RIGHT
2010 REM SEARCH S BELOW
2020 IF L+2 < X GOTO 2030 ELSE GOTO 2050
2030 IF M%(L+2,I) = 83 AND M%(L+2,I+2) = 83 GOTO 2040 ELSE GOTO 2050
2040 IF M%(L+1,I+1) = 65 THEN TOTAL = TOTAL + 1
2050 REM SEARCH S ABOVE
2060 IF L-2 < 0 GOTO 2090 ELSE GOTO 2070
2070 PRINT L,I: IF M%(L-2,I) = 83 AND M%(L-2,I+2) = 83 GOTO 2080 ELSE GOTO 2090
2080 IF M%(L-1,I+1) = 65 THEN TOTAL = TOTAL + 1: RETURN
2090 RETURN
3000 REM SUB: M BELOW
3010 REM SEARCH S ON THE RIGHT
3020 IF I + 2 < X GOTO 3030 ELSE GOTO 3050
3030 IF M%(L,I+2) = 83 AND M%(L+2,I+2) = 83 GOTO 3040 ELSE GOTO 3050
3040 IF M%(L+1,I+1) = 65 THEN TOTAL = TOTAL + 1
3050 REM SEARCH S ON THE LEFT
3060 IF I - 2 < 0 GOTO 3090 ELSE GOTO 3070
3070 IF M%(L,I-2) = 83 AND M%(L+2,I-2) = 83 GOTO 3080 ELSE GOTO 3090
3080 IF M%(L+1,I-1) = 65 THEN TOTAL = TOTAL + 1: RETURN
3090 RETURN
