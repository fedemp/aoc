10 CLS: OPEN "i", #1, "input.txt"
20 LNS=1176: DIM R%(100,100) : TOTAL = 0
30 FOR I=0 TO LNS-1
40 LINE INPUT #1, N$
50 R%( VAL(LEFT$(N$,2)) , VAL(RIGHT$(N$,2))) = 1
60 NEXT I
70 LINE INPUT #1, N$ ' White space
80 UP = 68: DIM U%(UP)
90 IF EOF(1) THEN PRINT TOTAL : END
100 LINE INPUT #1, N$
110 ERASE U%: DIM U%(UP)
120 REM POPULATE ARRAY WITH CURRENT LINE
130 FOR I=0 TO CINT(LEN(N$)/3)
140 U%(I) = VAL(MID$(N$, (I*3)+1, 3))
150 NEXT I
160 REM START TRAVERSING ARRAY
170 VALID = 0
180 FOR I=0 TO UP-1
190 C=U%(I): N=U%(I+1) ' Current and next
200 IF N=0 THEN GOTO 210 ELSE GOTO 230
210 TOTAL = TOTAL + U%(CINT(CINT(LEN(N$)/3)/2) -1)
220 GOTO 90 ' Parse next line
230 IF R%(C,N) = 1 THEN NEXT I ELSE GOTO 90
