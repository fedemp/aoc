5 PRINT TIME$
10 OPEN "i", #1, "input.txt"
20 TOTAL#= 0 : LIMIT = 12: DIM NUMS#(LIMIT)
30 IF EOF(1) THEN GOTO 220
40 LINE INPUT #1, LN$
50 PREVSP = 1: I = 0: ERASE NUMS# : DIM NUMS#(LIMIT)
60 COLON = INSTR(LN$, ":")
70 RES# = VAL(LEFT$(LN$, COLON)) : NUMS$ = RIGHT$(LN$, LEN(LN$) - COLON - 1)
80 SP = INSTR(PREVSP+1, NUMS$, " ")
90 IF SP<>0 THEN NUMS#(I)=VAL(MID$(NUMS$,PREVSP,SP-PREVSP))
100 IF SP<>0 THEN PREVSP=SP: I=I+1: GOTO 80
110 IF SP=0 THEN NUMS#(I) = VAL(RIGHT$(NUMS$,LEN(NUMS$)-PREVSP)) ELSE GOTO 80
130 FOR T=0 TO 2^(I)-1 : TOT# = RES# : FOR X=I-1 TO 1 STEP -1
140 NUMB=NUMS#(X)
150 IF T AND 2^X THEN GOTO 160 ELSE GOTO 170
160 IF (TOT#-INT(TOT#/NUMB)) = 0 THEN TOT#=TOT# / NUMB: GOTO 180 ELSE GOTO 200
170 IF (TOT#-NUMB) > 0 THEN TOT#=TOT#-NUMB: GOTO 180 ELSE GOTO 200
180 IF TOT# < NUMS#(0) GOTO 210
190 NEXT X
200 IF TOT# = NUMS#(0) THEN TOTAL# = TOTAL# + TOT#: GOTO 30
210 NEXT T: GOTO 30
220 PRINT "TOTAL" TOTAL#
225 PRINT TIME$
230 END
