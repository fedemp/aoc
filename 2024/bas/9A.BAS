5 STTIME$=TIME$
10 OPEN "I", #1, "input9.txt"
20 KILL "FILES.TXT": OPEN "R", #2, "FILES.TXT", 32: FIELD#2, 32 AS VALUE$
30 TY=-1: ID#=0: RECID=1 'FILE OR SPACE, ID NUMBER, RECORD ID
40 IF EOF(1) THEN GOTO 110
50 TY=(TY+1) MOD 2: V$ = INPUT$(1, #1)
60 FOR I=1 TO VAL(V$)
70 IF TY=0 THEN LSET VALUE$=MKD$(ID#) ELSE LSET VALUE$=MKD$(-1)
80 PUT #2, RECID: RECID=RECID+1
90 NEXT I: IF TY=0 THEN ID#=ID#+1
100 GOTO 40
110 CLOSE #1
120 TOTAL#=0: RIX=RECID-1
130 FOR I=1 TO RECID-1
140 GET #2, I: V# = CVD(VALUE$)
150 IF V# < 0 GOTO 160 ELSE GOTO 180
160 GET #2, RIX: V# = CVD(VALUE$): RIX=RIX-1
170 IF V# < 0 THEN GOTO 160
180 IF RIX+1 >= I AND I <= RIX THEN GOSUB 220 ELSE GOTO 210
200 NEXT I
210 PRINT "TOTAL#:" TOTAL# STTIME$, TIME$: END
220 IF V# > 0 THEN TOTAL# = TOTAL# + V#*(I-1)
230 RETURN
